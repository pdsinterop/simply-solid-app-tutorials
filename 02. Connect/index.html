<script type="module">
  import {
    getDefaultSession,
    login,
  } from 'https://cdn.skypack.dev/@inrupt/solid-client-authn-browser'

  const issuer = 'https://solidcommunity.net';

  const defaultSession = getDefaultSession()

  defaultSession.handleIncomingRedirect({url: window.location.href, restorePreviousSession: true})
    .then(sessionInfo => {
      if ( ! sessionInfo.isLoggedIn) {
        return login({
          oidcIssuer: issuer,
          redirectUrl: window.location.href,
        })
      }

      return sessionInfo
    })
</script>
